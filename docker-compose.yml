version: "3.8"

services:
  mcp-server:
    build: .
    container_name: mcs-doc-mcp-en
    restart: unless-stopped
    environment:
      VOYAGE_API_KEY: ${VOYAGE_API_KEY}
      QDRANT_URL: ${QDRANT_URL}
      QDRANT_API_KEY: ${QDRANT_API_KEY}
      SERVER_PORT: 8900
      DOC_LANGUAGE: ${DOC_LANGUAGE:-en}
    ports:
      - "${SERVER_PORT:-8900}:8900"
    volumes:
      - ./storage/logs:/app/storage/logs
      - ./config:/app/config:ro
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8900/health').raise_for_status()"]
      interval: 15s
      timeout: 5s
      retries: 3
